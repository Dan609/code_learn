

library(ggplot2) 

data(ToothGrowth)
head(ToothGrowth)

qplot(supp,len,data=ToothGrowth, facets=~dose, 
      main="Tooth growth of guinea pigs by supplement type and dosage (mg)",
      xlab="Supplement type", ylab="Tooth length") + geom_boxplot(aes(fill = supp))

OJ2 = ToothGrowth$len[ToothGrowth$supp == 'OJ' & ToothGrowth$dose == 0.5]
VC2 = ToothGrowth$len[ToothGrowth$supp == 'VC' & ToothGrowth$dose == 2]

t <- t.test(OJ2, VC2, alternative = "two.sided", paired = FALSE, var.equal = FALSE, conf.level = 0.95)

t_stat <- t$statistic

#???????????????? ?????????????? ???????????????? ?????????? ?????????? ????????????, ?????????????? ???????????????????? ???????????????????????? ?????? (OJ) ?? ???????????????????? 0.5 ????????????????????, ???? ?????????????? ?????????????????? ?????????? ?????????? ????????????, ?????????????? ???????????????????? ???????????????????????? ?????????????? (VC) ?? ???????????????????? 2 ??????????????????????. 

?ToothGrowth    
str(ToothGrowth)

hist(ToothGrowth$len)
#?????????????????????????? ?? ???????????????? ????????????????????

ggplot(ToothGrowth, aes(x = len ))+
  geom_histogram(fill = "white", col = "black", binwidth = 4)+
  facet_grid(supp ~ dose)
#?????????????????????????? ???? ???????????? ???? ???????? ?? ???? ???????????????? ??. ??????????, ?????? ?????? ?????????? ????????????????????

ggplot(ToothGrowth, aes(len, fill = supp))+
  geom_density(alpha = 0.5)
#?????????? ?????? ???????????? ???? ???????? ????????????

ggplot(ToothGrowth, aes(supp, len))+
  geom_boxplot()
#???????????????? ??????

shapiro.test(ToothGrowth$len)
by(ToothGrowth$len, INDICES = ToothGrowth$supp, shapiro.test)
#?????????? ???????? ???? ???????????????????????? ????????????, ?? ?????? ???????????????? ?????? ???????????? ???????????????????????? ?????? ?????????????????????????? ???????????????????? ?????????????? ????????????

hist(ToothGrowth$len[ToothGrowth$supp=='OJ'])
hist(ToothGrowth$len[ToothGrowth$supp=='VC'])
#???????????????? ??????????????????, ?? ??????????????????????, ?????? ?????????????????????????? ?????? ???????? ?????????????? ???????????????????? ????????????

bartlett.test(len  ~ supp, ToothGrowth)
#???????????????????? ??????????????????

#???????????????????? ????????????

by(df$len, INDICES = df$supp, shapiro.test)
#???????????? ???????????????? ???????? ???? ???????????????????????? ??????????????????????????

ggplot(df, aes(len, fill = supp))+
  geom_density(alpha = 0.5)
ggplot(df, aes(supp, len))+
  geom_boxplot()
#???????????????????? ???????????? ???????????????????????? ???????????????? ????????????????

df <- rbind(subset(ToothGrowth, supp == 'OJ' & dose == 0.5), subset(ToothGrowth, supp == 'VC' & dose == 2))
t.stat <- t.test(len ~ supp, df)$statistic
#?????????????? ???? ?????????????? ?????????????? ?????????????????????? 
